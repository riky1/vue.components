// Variabili per l'opacità dello state layer (possono essere affinate)
$btn-hover-state-opacity: 0.08;  // Opacità per lo stato hover
$btn-focus-state-opacity: 0.12;  // Opacità per lo stato focus
$btn-active-state-opacity: 0.10; // Opacità per lo stato active/pressed (Material Design usa 0.10)

// Variabili per le dimensioni dei bottoni
$btn-padding-y-sm: 0.375rem; // ~6px
$btn-padding-x-sm: 1rem;    // ~16px
$btn-font-size-sm: 0.75rem;  // ~12px

$btn-padding-y-lg: 0.875rem; // ~14px
$btn-padding-x-lg: 1.75rem;  // ~28px
$btn-font-size-lg: 1rem;     // ~16px

/* 
 * SECTION
 * Classe Base per i Bottoni
 */

.btn {
  // Stili fondamentali
  display: inline-flex;           // Permette di allineare icona e testo facilmente
  align-items: center;            // Allinea verticalmente il contenuto
  justify-content: center;        // Allinea orizzontalmente il contenuto
  gap: 0.5em;                     // Spazio tra icona e testo. Usa 'em' per farlo scalare con la dimensione del font
  padding: 0.625rem 1.25rem;      // ~10px vertical, 20px horizontal padding
  font-family: inherit;           // Eredita il font dal contesto
  font-size: 0.875rem;            // ~14px
  font-weight: 500;               // Medium weight, comune per i bottoni
  line-height: 1.5;               // Standard line height
  text-align: center;
  text-decoration: none;          // Rimuove la sottolineatura dai link usati come bottoni
  vertical-align: middle;
  cursor: pointer;
  user-select: none;              // Impedisce la selezione del testo del bottone
  background-color: transparent;  // Sfondo di base, sarà sovrascritto dai modificatori
  border: 1px solid transparent;  // Bordo di base, sarà sovrascritto
  border-radius: 1.25rem;         // ~20px, per un look "pill" o completamente arrotondato (Material Design style)
                                  // Adatto per un'altezza di bottone di circa 40px

  // Necessari per lo state layer e potenziali effetti ripple
  position: relative;
  overflow: hidden;                   // Maschera lo state layer se esce dai bordi arrotondati

  // Elevazione e trasformazione di scala di default
  box-shadow: var(--v-elevation-3);   // Elevazione a riposo (come da tua definizione precedente)
  transform: scale(1);                // Scala normale
  will-change: transform, box-shadow; // Fixa il movimento verso l'alto dell'icona all pressione del button

  // Transizioni per un feedback fluido
  // Usiamo cubic-bezier per un feeling più "Material"
  transition:
    background-color 0.2s ease-out,
    border-color 0.2s ease-out,
    color 0.2s ease-out,
    box-shadow 0.25s cubic-bezier(0.4, 0, 0.2, 1), // Easing standard Material per l'elevazione
    transform 0.15s cubic-bezier(0.4, 0, 1, 1);   // Easing standard Material per la scala

  /*
   * ANCHOR - State Layer 
   * (implementato con un pseudo-elemento ::before)
   * Questo layer si sovrappone al colore di sfondo del bottone per indicare gli stati
   */
  &::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    // Il colore di sfondo dello state layer sarà il colore del testo del bottone
    // (es. --v-color-on-primary per un bottone primario)
    background-color: currentColor;
    opacity: 0; // Inizialmente invisibile
    transition: opacity 0.2s ease-out; // Transizione per l'opacità
    pointer-events: none; // Non deve intercettare gli eventi del mouse
    border-radius: inherit; // Assicura che lo state layer segua il border-radius del bottone
  }

  /* 
   * ANCHOR - Stati Comuni
   */

  // Stili condivisi per :hover e :focus-visible (per accessibilità da tastiera)
  &:hover,
  &:focus-visible {
    text-decoration: none; // Manteniamo la rimozione della sottolineatura
    box-shadow: var(--v-elevation-4); // Elevazione per hover/focus (come da tua definizione)
  }

  // State layer per :hover
  &:hover::before {
    opacity: $btn-hover-state-opacity;
  }

  // Rimuove l'outline di default del browser se gestiamo il focus custom
  &:focus {
    outline: none;
  }

  // Stili specifici per :focus-visible (focus da tastiera)
  &:focus-visible {
    // Aggiunge un anello di focus esplicito per una migliore accessibilità
    outline: 2px solid var(--v-color-outline); // Usa un colore di outline neutro e visibile
    outline-offset: 2px;                       // Spazio tra bottone e anello di focus
    &::before {
      opacity: $btn-focus-state-opacity; // Opacità specifica per lo state layer in focus
    }
  }

  // Stato :active (quando il bottone è premuto)
  &:active {
    box-shadow: var(--v-elevation-2); // Elevazione per stato premuto (come da tua definizione)
    transform: scale(0.97);           // Leggera riduzione di scala per feedback tattile

    &::before {
      opacity: $btn-active-state-opacity; // Opacità specifica per lo state layer premuto
    }
  }

  // Stato :disabled (bottone disabilitato)
  &:disabled,
  &.disabled { // Permette di usare anche una classe .disabled
    // Stile disabilitato generico (Material Design 3 per bottoni filled/tonal)
    // Usa --v-color-on-surface-rgb che dovresti aver definito in _root.scss
    // Questo stile è un buon fallback se una variante non definisce il suo :disabled specifico.
    background-color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.12); // Fallback RGB se non definito
    color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.38);
    border-color: transparent; // I bottoni disabilitati filled/tonal di solito non hanno bordo
    cursor: not-allowed;
    pointer-events: none; // Impedisce qualsiasi interazione
    box-shadow: none;     // Nessuna elevazione quando disabilitato
    transform: scale(1);  // Resetta la scala
    &::before {
      opacity: 0; // Nessuno state layer quando disabilitato
    }
  }

  /*
   * ANCHOR - Elementi BEM interni al bottone
   */

  // Elemento per l'icona (es. <span class="btn__icon">...</span>)
  &__icon {
    // margin-right: 0.5em;     // Spazio tra icona e testo
    display: inline-flex;       // Utile per l'allineamento verticale dell'icona
    align-items: center;
    position: relative;
    top: 1px;                   // necessario per lo scostamento dovuto a will-change
    // Le icone SVG potrebbero necessitare di fill: currentColor; o width/height specifici
  }

  &--icon-right {
    // Quando l'icona deve stare a destra, cambiamo l'ordine degli elementi flex
    .btn__icon {
      order: 1; // Sposta l'icona dopo il testo (che ha l'ordine di default 0)
    }
  }

  // Elemento per il testo (es. <span class="btn__text">...</span>)
  // Utile se si vuole dare uno stile specifico solo al testo
  // &__text {
  //   // display: inline-block; // o span
  // }
}
// !SECTION

/* 
 * SECTION
 * Modificatore per Bottone Primario (.btn--primary)
 */

.btn--primary {
  background-color: var(--v-color-primary);
  border-color: var(--v-color-primary);
  // Il colore del testo (on-primary) sarà usato anche per lo state layer (grazie a background-color: currentColor in ::before)
  color: var(--v-color-on-primary);

  // Opzionale: se il bottone primario necessita di un anello di focus con un colore diverso
  // &:focus-visible {
  //   outline-color: var(--v-color-primary-light); // Esempio: usa una variante chiara del primario
  // }

  // Stato disabilitato specifico per il primario (Material Design 3 per bottoni "filled")
  &:disabled,
  &.disabled {
    background-color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.12);
    color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.38);
    border-color: transparent;
  }
}
// !SECTION

/*
 * SECTION
 * Modificatore per Bottone Secondario/Outlined (.btn--secondary)
 */
.btn--secondary {
  // Il colore del testo (primary) sarà usato anche per lo state layer
  color: var(--v-color-primary);
  background-color: transparent;
  border-color: var(--v-color-outline); // Bordo standard per outlined

  // Per lo stato disabilitato, potremmo voler solo sbiadire il bordo e il testo
  &:disabled,
  &.disabled {
    // Per bottoni outlined/text, il testo e il bordo (se presente) usano on-surface con opacità 0.38
    color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.38);
    border-color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.12); // Bordo con on-surface al 12%
    background-color: transparent;
  }
}
// !SECTION

/*
 * SECTION
 * Modificatore per Bottone Terziario/Text (.btn--text)
 */
.btn--text {
  // Il colore del testo (primary) sarà usato anche per lo state layer
  color: var(--v-color-primary);
  background-color: transparent;
  border-color: transparent;
  padding-left: 0.75rem; // Meno padding orizzontale per i text button
  padding-right: 0.75rem;

  // Per lo stato disabilitato
  &:disabled,
  &.disabled {
    color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.38);
    background-color: transparent;
    border-color: transparent;
  }
}
// !SECTION

/*
 * SECTION
 * Modificatore per Bottone Tonal (.btn--tonal)
 */
.btn--tonal {
  background-color: var(--v-color-secondary-container);
  // Il colore del testo (on-secondary-container) sarà usato anche per lo state layer
  color: var(--v-color-on-secondary-container);
  border-color: transparent;

  // Per lo stato disabilitato
  &:disabled,
  &.disabled {
    // Material Design 3 suggerisce on-surface al 12% per lo sfondo e on-surface al 38% per il testo
    background-color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.12);
    color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.38);
    border-color: transparent;
  }
}
// !SECTION

/*
 * SECTION
 * Modificatore per Bottone con tema Terziario (.btn--tertiary)
 */
.btn--tertiary {
  background-color: var(--v-color-tertiary);
  color: var(--v-color-on-tertiary); // Usato per testo e state layer
  border-color: transparent; // O var(--v-color-tertiary-dark) per un bordo sottile

  // Lo state layer (::before) userà 'currentColor' (cioè --v-color-on-tertiary)
  // per il suo background, come definito negli stili base .btn

  &:disabled,
  &.disabled {
    // Stile disabilitato per bottoni filled (Material Design 3)
    // Usa --v-color-on-surface-rgb che dovresti aver definito in _root.scss
    // Se --v-color-on-surface-rgb non è disponibile, usa un fallback o un approccio più semplice.
    background-color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.12);
    color: rgba(var(--v-color-on-surface-rgb, 229, 231, 235), 0.38);
     
    border-color: transparent;
    // box-shadow e cursor sono già gestiti dagli stili :disabled di .btn base
  }
}

// !SECTION

/*
 * SECTION
 * Modificatori per le Dimensioni dei Bottoni
 */

.btn--sm {
  padding: $btn-padding-y-sm $btn-padding-x-sm;
  font-size: $btn-font-size-sm;
  // Opzionale: aggiustare il border-radius se l'altezza cambia significativamente
  // border-radius: 1rem; // Esempio per un bottone più piccolo

  // Per i text button piccoli, potrebbe essere necessario un padding orizzontale ancora minore
  &.btn--text {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }
}

.btn--lg {
  padding: $btn-padding-y-lg $btn-padding-x-lg;
  font-size: $btn-font-size-lg;
  // Opzionale: aggiustare il border-radius
  // border-radius: 1.5rem; // Esempio per un bottone più grande
}

// !SECTION